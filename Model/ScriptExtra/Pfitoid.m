close all; clear all;
Pmax = [0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;31.2057860668248;77.1442995175588;125.606666977767;176.621721492093;230.217178261641;286.419631360412;345.254551157428;406.746282431277;470.918043161054;537.791923982298;607.388888292421;679.728772990216;754.830289838657;832.711027435540;913.387453778486;996.874919410100;1083.18766113270;1172.33880627528;1264.34037750309;1359.20329815373;1456.93739809087;1557.55142005696;1661.05302651843;1767.44880698468;1876.74428579386;1988.94393035012;2104.05115979757;2222.06835412516;2342.99686368395;2466.83701910878;2593.58814163025;2723.24855376608;2855.81559038125;2991.28561010116;3129.65400707245;3270.91522305498;3415.06275983627;3562.08919195535;3711.98617972709;3864.74448255528;4020.35397252212;4178.80364824464;4340.08164898834;4504.17526902562;4671.07097222827;4840.75440688729;5013.21042074416;5188.42307622805;5366.37566588758;5547.05072800683;5730.43006239394;5916.49474633658;6105.22515071242;6296.60095624501;6490.60116989296;6687.20414137242;6886.38757979032;7088.12857039077;7292.40359139849;7499.18853095590;7708.45870413767;7920.18887004330;8134.35324894959;8350.92553952388;8569.87893608264;8791.18614588770;9014.81940647785;9240.75050302327;9468.95078568935;9699.39118701800;9932.04223929933;10166.8740919402;10403.8565288189;10642.9589856126;10884.1505670966;11127.4000644073;11372.6759722597;11619.9465061131;11869.1796192782;12120.3430199618;12373.4041882339;12628.3303929247;12885.0887084256;13143.6460314100;13403.9690974485;13666.0244975254;13929.7786944419;14195.1980391049;14462.2487866948;14730.8971127034;15001.1091288414;15272.8508988056;15546.0884539063;15820.7878085342;16096.9149754890;16374.4359811321;16653.3168803840;16933.5237715529;17215.0228109825;17497.7802275225;17781.7623368221;18066.9355554235;18353.2664146728;18640.7215744288;18929.2678365706;19218.8721583029;19509.5016652517;19801.1236643430;20093.7056564656;20387.2153489196;20681.6206676327;20976.8897691548;21272.9910524188;21569.8931702661;21867.5650407376;22165.9758581274;22465.0951037811;22764.8925566670;23065.3383036779;23366.4027496962;23668.0566274048;23970.2710068278;24273.0173046310;24576.2672931482;24879.9931091509;25184.1672623507;25488.7626436384;25793.7525330502;26099.1106074667;26404.8109480367;26710.8280473334;27017.1368162330;27323.7125905134;27630.5311371870;27937.5686605425;28244.8018079131;28552.2076751765;28859.7638119461;29167.4482265147;29475.2393904918;29783.1162431669;30091.0581955993;30399.0451344074;30707.0574252931;31015.0759162640;31323.0819406030;31631.0573195192;31938.9843645410;32246.8458796299;32554.6251629885;32862.3060086175;33169.8727075724;33477.3100489547;33784.6033206111;34091.7383095731;34398.7013022052;34705.4790840891;35012.0589396249;35318.4286513730;35624.5764991185;35930.4912586642;36236.1622003714;36541.5790874066;36846.7321737720;37151.6122020245;37456.2104007673;37760.5184818835;38064.5286375023;38368.2335367329;38671.6263221326;38974.7006059260;39277.4504660164;39579.8704417072;39881.9555292210;40183.7011769783;40485.1032806350;40786.1581779022;41086.8626431443;41387.2138817449;41687.2095242659;41986.8476203897;42286.1266326677;42585.0454300237;42883.6032811116;43181.7998474251;43479.6351762570;43777.1096934353;44074.2241958942;44370.9798440783;44667.3781541468;44963.4209900107;45259.1105552360;45554.4493847558;45849.4403364284;46144.0865824834;46438.3916007614;46732.3591658854;47025.9933402422;47319.2984648785;47612.2791502455;47904.9402668377;48197.2869357344;48489.3245190211;48781.0586101235;49072.4950240598;49363.6397875670;49654.4991292101;49945.0794693690;50235.3874101975;50525.4297254784;50815.2133504919;51104.7453717886;51394.0330169261;51683.0836442295;51971.9047324478;52260.5038704775;52548.8887470217;52837.0671402644;53125.0469075738;53412.8359752042;53700.4423279841;53987.8739991565;54275.1390600698;54562.2456101310;54849.2017666406;55136.0156547780;55422.6953976621;55709.2491064575;55995.6848706016;56282.0107481240;56568.2347560619;56854.3648610141;57140.4089698118;57426.3749203288;57712.2704724461;57998.1032991322;58283.8809777809;58569.6109815752;58855.3006712139;59140.9572866931;59426.5879393701;59712.1996041728;59997.7991121455;60283.3931430937;60568.9882186042;60854.5906952194;61140.2067579412;61425.8424140039;61711.5034869010;61997.1956107674;62282.9242250261;62568.6945693607;62854.5116790925;63140.3803807557;63426.3052882299;63712.2907990467;63998.3410911887;64284.4601202563;64570.6516170463;64856.9190855050;65143.2658011594;65429.6948099859;65716.2089276846;66002.8107394509;66289.5026002471;66576.2866355084;66863.1647424469;67150.1385917072;67437.2096297551;67724.3790816308;68011.6479543751;68299.0170409828;68586.4869248994;68874.0579851922;69161.7304022641;69449.5041642345;69737.3790739186;70025.3547565125;70313.4306678330;70601.6061033935;70889.8802080537;71178.2519863993;71466.7203138696;71755.2839486501;72043.9415441793;72332.6916626014;72621.5327888975;72910.4633457988;73199.4817095624;73488.5862265599;73777.7752306954;74067.0470616511;74356.4000841155;74645.8327077365;74935.3434081000;75224.9307486142;75514.5934032550;75804.3301803713;76094.1400473201;76384.0221562594;76673.9758707716;76964.0007936075;77254.0967954589;77544.2640446623;77834.5030381855;78124.8146334514;78415.2000815263;78705.6610610960;78996.1997139623;79286.8186812894;79577.5211414139;79868.3108485051;80159.1921726647;80450.1701410713;80741.2504804866;81032.4396610736;81323.7449411805;81615.1744138525;81906.7370543511;82198.4427690275;82490.3024457161;82782.3280053322;83074.5324548933;83366.9299419968;83659.5358106547;83952.3666586403;84245.4403961633;84538.7763062559;84832.3951064422;85126.3190119306;85420.5718006051;85715.1788791661;86010.1673512820;86305.5660870043;86601.4057939323;86897.7190899838;87194.5405780112;87491.9069216728;87789.8569234405;88088.4316040896;88387.6742840059;88687.6306661353;88988.3489209902;89289.8797730572;89592.2765894219;89895.5954699636;90199.8953394708;90505.2380418257;90811.6884358401;91119.3144931173;91428.1873979872];
Vin = [0:0.01:5]';
X = [0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0];


for i = 1:length(Vin)
   if Pmax(i) <= 0
       Vout(i) = 0;
    elseif Pmax(i) < 8800
       a =  - 0.000000004;
       b = 16000;
       Vout(i) = a*(Pmax(i)- b)^2 + 1.49 - a*(Pmax(1)- b)^2;
       k = i;
   elseif Pmax(i) > 40000
       Vout(i) = 3.3978e-05*Pmax(i) + Vout(k)-3.3978e-05*Pmax(k);
   end
    
end
hold on
plot(Pmax, Vin)
plot(Pmax, Vout)